{% extends 'layouts/box.html' %}

{% block content %}

    <h1>Enable Two-Factor Authentication</h1>

    <p>To start using two-factor authentication, please use your smartphone to scan the QR code below. Alternatively, you can use the following secret to set it up manually in your authenticator app.</p>

    <p><img src="{{ QR_URL }}" alt="QR Code" class="bg-white"/></p>

    <p>Alternatively, you can use the following secret to set up TOTP manually in your authenticator app:</p>
    <p><strong>TOTP Secret:</strong> <a href="{{ otpauth_url }}">{{ secret_key }}</a></p>

    <p>Once you have scanned the QR code or entered the secret, please enter the token generated by your app below.</p>

    <form action="" method="post">
        {% csrf_token %}
        <label for="otp-token">Enter the token:</label>
        <input type="text" id="otp-token" name="otp_token" required>
        <input type="submit" value="Verify">
        <button type="submit" name="cancel" value="true" formnovalidate>Cancel</button>
    </form>

{% endblock %}